import{c as Ye,r as Ae,R as Ze,j as t,L as Re,b as G,H as et}from"./app-foq6J3Wm.js";import{c as tt,B as $e}from"./createLucideIcon-Bqfhkh97.js";import{I as st}from"./input-C0IELLqB.js";import{T as Ie,a as o,b as m,c as at,d as lt,e as rt}from"./table-C6fAtHGh.js";import{F as Be,a as it,b as nt,c as ct,d as Ee,e as ot,S as dt,D as mt}from"./DashboardLayout-B1vzj0Eb.js";import{a as Fe,b as He,d as O,c as Le,S as Ve}from"./select-CZrvMyYJ.js";import{B as qe}from"./badge-aNAX_hIc.js";import{C as Ue}from"./checkbox-fHgKjzWu.js";import{A as ze,a as Ge}from"./alert-BWVVNhnC.js";import{P as ht}from"./pagination-DK-WKep6.js";import{P as ft}from"./PageHeader-CjlLEdaG.js";import{T as Oe}from"./trash-2-IpYvhmDX.js";import{C as xt,a as ut}from"./users-5_2PwUWT.js";import{E as pt}from"./ellipsis-vertical-fzsDRsz_.js";import{E as jt}from"./eye-CoCVfqIL.js";import{S as gt}from"./square-pen-CFbwIvnc.js";import{P as bt}from"./plus-CraGd4xZ.js";import{T as vt}from"./trending-up-sJ_y-Nm-.js";/* empty css            */import"./index-DsPN9njH.js";import"./user-C0BVgP1f.js";import"./index-Cy5PQ3x5.js";import"./check-CC-XO48a.js";import"./house-BtSlzCE1.js";/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],Nt=tt("calendar-clock",_t);function Zt(l){const e=Ye.c(118),{tranches:a,filters:n,stats:i,configurations:Se,flash:c}=l;let J;e[0]===Symbol.for("react.memo_cache_sentinel")?(J=[],e[0]=J):J=e[0];const[r,z]=Ae.useState(J),[d,Je]=Ae.useState(n.search||"");let K,Q;e[1]!==d?(K=()=>{const s=setTimeout(()=>{G.get("/tranches",{search:d},{preserveState:!0,replace:!0})},500);return()=>clearTimeout(s)},Q=[d],e[1]=d,e[2]=K,e[3]=Q):(K=e[2],Q=e[3]),Ze.useEffect(K,Q);let W;e[4]!==n?(W=(s,U)=>{G.get("/tranches",{...n,[s]:U},{preserveState:!0,replace:!0})},e[4]=n,e[5]=W):W=e[5];const h=W;let X;e[6]!==a.data?(X=s=>{z(s?a.data.map(kt):[])},e[6]=a.data,e[7]=X):X=e[7];const ye=X;let Y;e[8]!==r?(Y=(s,U)=>{z(U?[...r,s]:r.filter(Pe=>Pe!==s))},e[8]=r,e[9]=Y):Y=e[9];const we=Y;let Z;e[10]!==r?(Z=s=>{r.length!==0&&confirm(`Êtes-vous sûr de vouloir supprimer ${r.length} tranche(s) ?`)&&G.post("/tranches/bulk-action",{ids:r,action:s},{onSuccess:()=>z([])})},e[10]=r,e[11]=Z):Z=e[11];const Te=Z,Ke=Ct,Ce=Tt,Qe=wt,We=yt;let ee;e[12]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx(et,{title:"Gestion des tranches"}),e[12]=ee):ee=e[12];const Xe=a.total;let te;e[13]!==i.montant_total?(te=Ce(i.montant_total),e[13]=i.montant_total,e[14]=te):te=e[14];const ke=`${Xe} tranches - Total: ${te}`;let se;e[15]===Symbol.for("react.memo_cache_sentinel")?(se=[{label:"Dashboard",href:"/dashboard"},{label:"Configuration frais",href:"/configuration-frais"},{label:"Tranches",href:"/tranches"}],e[15]=se):se=e[15];let f;e[16]!==Te||e[17]!==r.length?(f=r.length>0&&t.jsxs($e,{variant:"destructive",onClick:()=>Te("delete"),children:[t.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Supprimer (",r.length,")"]}),e[16]=Te,e[17]=r.length,e[18]=f):f=e[18];let ae;e[19]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(Re,{href:"/tranches/create",children:t.jsxs($e,{children:[t.jsx(bt,{className:"h-4 w-4 mr-2"}),"Nouvelle tranche"]})}),e[19]=ae):ae=e[19];let x;e[20]!==f?(x=t.jsxs("div",{className:"flex items-center gap-2",children:[f,ae]}),e[20]=f,e[21]=x):x=e[21];let u;e[22]!==ke||e[23]!==x?(u=t.jsx(ft,{title:"Tranches",description:ke,breadcrumb:se,actions:x}),e[22]=ke,e[23]=x,e[24]=u):u=e[24];let p;e[25]!==c?(p=c?.success&&t.jsx(ze,{className:"mb-6",children:t.jsx(Ge,{children:c.success})}),e[25]=c,e[26]=p):p=e[26];let j;e[27]!==c?(j=c?.error&&t.jsx(ze,{variant:"destructive",className:"mb-6",children:t.jsx(Ge,{children:c.error})}),e[27]=c,e[28]=j):j=e[28];let le;e[29]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total tranches"}),e[29]=le):le=e[29];let g;e[30]!==i.total?(g=t.jsxs("div",{children:[le,t.jsx("p",{className:"text-2xl font-bold",children:i.total})]}),e[30]=i.total,e[31]=g):g=e[31];let re;e[32]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(Be,{className:"h-8 w-8 text-primary"}),e[32]=re):re=e[32];let b;e[33]!==g?(b=t.jsx("div",{className:"bg-card rounded-lg border p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[g,re]})}),e[33]=g,e[34]=b):b=e[34];let ie;e[35]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Montant total"}),e[35]=ie):ie=e[35];let v;e[36]!==i.montant_total?(v=Ce(i.montant_total),e[36]=i.montant_total,e[37]=v):v=e[37];let _;e[38]!==v?(_=t.jsxs("div",{children:[ie,t.jsx("p",{className:"text-2xl font-bold",children:v})]}),e[38]=v,e[39]=_):_=e[39];let ne;e[40]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(vt,{className:"h-8 w-8 text-blue-500"}),e[40]=ne):ne=e[40];let N;e[41]!==_?(N=t.jsx("div",{className:"bg-card rounded-lg border p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[_,ne]})}),e[41]=_,e[42]=N):N=e[42];let ce;e[43]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Échéances proches"}),e[43]=ce):ce=e[43];let S;e[44]!==i.prochaines_echeances?(S=t.jsxs("div",{children:[ce,t.jsx("p",{className:"text-2xl font-bold",children:i.prochaines_echeances})]}),e[44]=i.prochaines_echeances,e[45]=S):S=e[45];let oe;e[46]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx(Nt,{className:"h-8 w-8 text-amber-500"}),e[46]=oe):oe=e[46];let y;e[47]!==S?(y=t.jsx("div",{className:"bg-card rounded-lg border p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[S,oe]})}),e[47]=S,e[48]=y):y=e[48];let w;e[49]!==b||e[50]!==N||e[51]!==y?(w=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[b,N,y]}),e[49]=b,e[50]=N,e[51]=y,e[52]=w):w=e[52];let de;e[53]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx(dt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e[53]=de):de=e[53];let me;e[54]===Symbol.for("react.memo_cache_sentinel")?(me=s=>Je(s.target.value),e[54]=me):me=e[54];let T;e[55]!==d?(T=t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[de,t.jsx(st,{placeholder:"Rechercher par nom ou configuration...",value:d,onChange:me,className:"pl-10"})]})}),e[55]=d,e[56]=T):T=e[56];const De=n.configuration_frai_id||"";let C;e[57]!==h?(C=s=>h("configuration_frai_id",s),e[57]=h,e[58]=C):C=e[58];let he;e[59]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsxs(Fe,{className:"w-[220px]",children:[t.jsx(ut,{className:"h-4 w-4 mr-2"}),t.jsx(He,{placeholder:"Configuration de frais"})]}),e[59]=he):he=e[59];let fe;e[60]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(O,{value:"all",children:"Toutes configurations"}),e[60]=fe):fe=e[60];let k;e[61]!==Se?(k=Se.map(St),e[61]=Se,e[62]=k):k=e[62];let D;e[63]!==k?(D=t.jsxs(Le,{children:[fe,k]}),e[63]=k,e[64]=D):D=e[64];let M;e[65]!==De||e[66]!==C||e[67]!==D?(M=t.jsxs(Ve,{value:De,onValueChange:C,children:[he,D]}),e[65]=De,e[66]=C,e[67]=D,e[68]=M):M=e[68];let P;e[69]!==n.per_page?(P=n.per_page?.toString()||"10",e[69]=n.per_page,e[70]=P):P=e[70];let R;e[71]!==h?(R=s=>h("per_page",s),e[71]=h,e[72]=R):R=e[72];let xe;e[73]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx(Fe,{className:"w-[100px]",children:t.jsx(He,{placeholder:"Par page"})}),e[73]=xe):xe=e[73];let ue;e[74]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsxs(Le,{children:[t.jsx(O,{value:"10",children:"10"}),t.jsx(O,{value:"25",children:"25"}),t.jsx(O,{value:"50",children:"50"})]}),e[74]=ue):ue=e[74];let $;e[75]!==P||e[76]!==R?($=t.jsxs(Ve,{value:P,onValueChange:R,children:[xe,ue]}),e[75]=P,e[76]=R,e[77]=$):$=e[77];let I;e[78]!==M||e[79]!==$?(I=t.jsxs("div",{className:"flex gap-2",children:[M,$]}),e[78]=M,e[79]=$,e[80]=I):I=e[80];let E;e[81]!==T||e[82]!==I?(E=t.jsx("div",{className:"bg-card rounded-lg border p-4 mb-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[T,I]})}),e[81]=T,e[82]=I,e[83]=E):E=e[83];const Me=r.length===a.data.length&&a.data.length>0;let A;e[84]!==ye||e[85]!==Me?(A=t.jsx(m,{className:"w-12",children:t.jsx(Ue,{checked:Me,onCheckedChange:ye})}),e[84]=ye,e[85]=Me,e[86]=A):A=e[86];let pe,je,ge,be,ve,_e;e[87]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(m,{children:"Tranche"}),je=t.jsx(m,{children:"Configuration"}),ge=t.jsx(m,{children:"Montant"}),be=t.jsx(m,{children:"Date limite"}),ve=t.jsx(m,{children:"Ordre"}),_e=t.jsx(m,{className:"text-right",children:"Actions"}),e[87]=pe,e[88]=je,e[89]=ge,e[90]=be,e[91]=ve,e[92]=_e):(pe=e[87],je=e[88],ge=e[89],be=e[90],ve=e[91],_e=e[92]);let B;e[93]!==A?(B=t.jsx(at,{children:t.jsxs(Ie,{children:[A,pe,je,ge,be,ve,_e]})}),e[93]=A,e[94]=B):B=e[94];let F;e[95]!==we||e[96]!==r||e[97]!==a.data?(F=a.data.length===0?t.jsx(Ie,{children:t.jsxs(o,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:[t.jsx(Be,{className:"h-12 w-12 mx-auto mb-4 opacity-20"}),t.jsx("p",{className:"text-lg",children:"Aucune tranche trouvée"})]})}):a.data.map(s=>{const U=We(s.date_limite);return t.jsxs(Ie,{className:"hover:bg-muted/50",children:[t.jsx(o,{children:t.jsx(Ue,{checked:r.includes(s.id),onCheckedChange:Pe=>we(s.id,Pe===!0)})}),t.jsx(o,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:s.nom_tranche}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Réf: ",s.ref]})]})}),t.jsx(o,{children:s.configuration_frais?t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:s.configuration_frais.nom_frais}),t.jsx("div",{className:"text-xs text-muted-foreground",children:s.configuration_frais.annee_scolaire})]}):t.jsx("span",{className:"text-sm text-muted-foreground",children:"Non assignée"})}),t.jsx(o,{className:"font-semibold",children:Ce(s.montant)}),t.jsx(o,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(xt,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"font-medium",children:Qe(s.date_limite)}),t.jsx(qe,{variant:U.variant,className:"text-xs",children:U.label})]})}),t.jsx(o,{children:t.jsxs(qe,{variant:"outline",className:"font-mono",children:["#",s.ordre]})}),t.jsx(o,{className:"text-right",children:t.jsxs(it,{children:[t.jsx(nt,{asChild:!0,children:t.jsx($e,{variant:"ghost",size:"icon",children:t.jsx(pt,{className:"h-4 w-4"})})}),t.jsxs(ct,{align:"end",children:[t.jsx(Re,{href:`/tranches/${s.id}`,children:t.jsxs(Ee,{children:[t.jsx(jt,{className:"h-4 w-4 mr-2"}),"Voir"]})}),t.jsx(Re,{href:`/tranches/${s.id}/edit`,children:t.jsxs(Ee,{children:[t.jsx(gt,{className:"h-4 w-4 mr-2"}),"Modifier"]})}),t.jsx(ot,{}),t.jsxs(Ee,{onClick:()=>Ke(s),className:"text-destructive",children:[t.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]})})]},s.id)}),e[95]=we,e[96]=r,e[97]=a.data,e[98]=F):F=e[98];let H;e[99]!==F?(H=t.jsx(lt,{children:F}),e[99]=F,e[100]=H):H=e[100];let L;e[101]!==B||e[102]!==H?(L=t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(rt,{children:[B,H]})}),e[101]=B,e[102]=H,e[103]=L):L=e[103];let V;e[104]!==n||e[105]!==a.current_page||e[106]!==a.last_page?(V=a.last_page>1&&t.jsx("div",{className:"border-t p-4",children:t.jsx(ht,{currentPage:a.current_page,totalPages:a.last_page,onPageChange:s=>{G.get("/tranches",{...n,page:s},{preserveState:!0,replace:!0})}})}),e[104]=n,e[105]=a.current_page,e[106]=a.last_page,e[107]=V):V=e[107];let q;e[108]!==L||e[109]!==V?(q=t.jsxs("div",{className:"bg-card rounded-lg border overflow-hidden",children:[L,V]}),e[108]=L,e[109]=V,e[110]=q):q=e[110];let Ne;return e[111]!==u||e[112]!==p||e[113]!==j||e[114]!==w||e[115]!==E||e[116]!==q?(Ne=t.jsxs(t.Fragment,{children:[ee,t.jsxs(mt,{activeRoute:"/tranches",children:[u,p,j,w,E,q]})]}),e[111]=u,e[112]=p,e[113]=j,e[114]=w,e[115]=E,e[116]=q,e[117]=Ne):Ne=e[117],Ne}function St(l){return t.jsxs(O,{value:l.id.toString(),children:[l.nom_frais," (",l.annee_scolaire,")"]},l.id)}function yt(l){const e=new Date,n=new Date(l).getTime()-e.getTime(),i=Math.ceil(n/864e5);return i<0?{label:"Échue",variant:"destructive"}:i<=7?{label:"Bientôt",variant:"warning"}:i<=30?{label:"Proche",variant:"default"}:{label:"Loin",variant:"secondary"}}function wt(l){return new Date(l).toLocaleDateString("fr-FR")}function Tt(l){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(l).replace("$US","$")}function Ct(l){confirm(`Êtes-vous sûr de vouloir supprimer "${l.nom_tranche}" ?`)&&G.delete(`/tranches/${l.id}`)}function kt(l){return l.id}export{Zt as default};
